<!--
Page Name : LX_EE_WorkgroupOCR
Description : This page is written for EASY ESTIMATE Workgroup OCR record creation.
Created By : Madhurupa Ghose Roy (mghoseroy@deloitte.com)
Created Date : 29-9-2013
Modification Log:
---------------------------------------------------------------------------
Developer             Date            Modification ID        Description
---------------------------------------------------------------------------
Madhurupa Ghose Roy  29-9-2013        1000                   Initial Version
***************************************************************************-->
<apex:page standardController="STAR__c" extensions="LX_EE_WorkgroupOCRExtn">
  <script type="text/javascript">               
    function nod(a,b,c){
      a = a.value;
      this.b = b ;
      this.c = c.value ;
      if(a<10||a>250){
        var r=confirm(b);   
        if(r==true){
          parent.window.location.replace("/"+c);
        }     
      }    
    }
    function led(a,b,c) {
      a = a.value;
      this.b = b ; 
      this.c = c.value ;   
      if(a=='No'){
        var r=confirm(b);   
        if (r==true){
          parent.window.location.replace("/"+c);
        }       
      }    
    }   
    function GeneratePDFonEnter(e){
      if(window.event){                    
        key = window.event.keyCode;     //IE               
      } 
      else{                    
        key = e.which;     //firefox               
      }               
      if(key == 13) {                    
        var ele=document.getElementById('{!$Component.form.pb.pbButtons.generateDocButtonId}'); 
        ele.click();                     
        return false;               
      } 
      else {                    
        return true;               
      }          
    }        
  </script>
  
  <style>
    .headerColumn{text-align: right;}
  </style>
  
  <apex:form id="form">
   <apex:pageMessages id="pgmsg"/>
    <apex:pageBlock title="Easy Estimate: Workgroup OCR" id="pb">
      <apex:pageBlockButtons location="bottom" id="pbButtons">
        <apex:commandButton value="Generate Customer Document" action="{!GenerateDoc}" id="generateDocButtonId"/>
      </apex:pageBlockButtons>
      {!$Label.Step1WG} 
      <br/><br/>
      
      <apex:pageBlockSection columns="1" id="Block">
        <apex:inputField value="{!PSObj.LX_Customer_Name__c}"/>
        <apex:inputField value="{!PSObj.LX_Customer_Type__c}" > 
          <apex:actionSupport event="onchange" reRender="Block"/>
        </apex:inputField>      
        <apex:inputField value="{!PSObj.LX_Conversion_Rate__c}" rendered="{!PSObj.LX_Customer_Type__c=='Canada'}" />       
      </apex:pageBlockSection>  
        
      <apex:pageBlockSection title="Hardware" columns="1">       
        <apex:inputField value="{!PSObj.LX_Number_of_devices__c}" onblur="nod(this,'{!$Label.Device_Range_JSWG}','{!opp}');" onkeypress="return GeneratePDFonEnter(event)">&nbsp;&nbsp;&nbsp;&nbsp;<i>{!$Label.DeviceRangeNoteWG}</i>
          <apex:actionSupport action="{!Calculations}" event="onkeyup" rerender="caltable" status="counterStatus"/>
        </apex:inputField>
        <apex:inputField value="{!PSObj.LX_All_lexmatk_devices__c}" onblur="led(this,'{!$Label.Lexmark_Devices_JSWG}','{!opp}');" />
      </apex:pageBlockSection>
      
      <br/><br/>
        <apex:actionStatus id="counterStatus" startText="Calculating..." stopText="Done"/>
      <br/><br/>
      
      <apex:outputPanel id="caltable">
        <apex:pageBlockTable value="{!PSObj}" var="item" title="Budgetary Estimate" align="center" frame="box">
          <apex:column headerValue="Description"> 
            Licensing and 1st Year Support<br/><br/>
            Professional Services<br/><br/>
            <b>Total</b><br/><br/>
            <b>Per Device Cost</b><br/><br/><br/><br/>
            <b>Annual Support Renewal After Year 1</b>
          </apex:column>         
          <apex:column headerValue="Minimum Range" style="text-align:right;" headerClass="headerColumn"> 
            <apex:outputText value="{0,number,$###,###,##0}"><apex:param value="{!PSObj.Licensing_and_1st_year_support_min_value__c}"/></apex:outputText><br/><br/>
            <apex:outputText value="{0,number,$###,###,##0}"><apex:param value="{!PSObj.Profession_services_min_value__c}"/></apex:outputText><br/><br/>
            <b><apex:outputText value="{0,number,$###,###,##0}"><apex:param value="{!PSObj.Total_min_value__c}"/></apex:outputText></b><br/><br/>
            <b><apex:outputText value="{0,number,$###,###,##0}"><apex:param value="{!PSObj.Per_device_min_value__c}"/></apex:outputText></b><br/><br/><br/><br/>
            <apex:outputText value="{0,number,$###,###,##0}"><apex:param value="{!PSObj.Anuual_support_renewal_after_year1_min_v__c}"/></apex:outputText>
          </apex:column>
          <apex:column headerValue="Maximum Range" style="text-align:right;" headerClass="headerColumn"> 
            <apex:outputText value="{0,number,$###,###,##0}"><apex:param value="{!PSObj.Licensing_and_1st_year_support_max_value__c}"/></apex:outputText><br/><br/>
            <apex:outputText value="{0,number,$###,###,##0}"><apex:param value="{!PSObj.Profession_services_max_value__c}"/></apex:outputText><br/><br/>
            <b><apex:outputText value="{0,number,$###,###,##0}"><apex:param value="{!PSObj.Total_max_value__c}"/></apex:outputText></b><br/><br/>
            <b><apex:outputText value="{0,number,$###,###,##0}"><apex:param value="{!PSObj.Per_device_max_value__c}"/></apex:outputText></b><br/><br/><br/><br/>
            <apex:outputText value="{0,number,$###,###,##0}"><apex:param value="{!PSObj.Anuual_support_renewal_after_year1_max_v__c}"/></apex:outputText>
          </apex:column>
        </apex:pageBlockTable> 
        <br/>
      </apex:outputPanel>
      {!$Label.Step2WG} 
    </apex:pageBlock>
  </apex:form>
</apex:page>